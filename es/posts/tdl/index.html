<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=es><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Traductor De Lenguajes - azuar4e</title><meta name=author content="Angel Azuara Eizaguirre"><meta name=description content="Un proyecto universitario de la asignatura Traductores de Lenguajes."><meta name=keywords content='Java,Python'><meta itemprop=name content="Traductor de Lenguajes"><meta itemprop=description content="Un proyecto universitario de la asignatura Traductores de Lenguajes."><meta itemprop=datePublished content="2025-06-17T12:30:24+02:00"><meta itemprop=dateModified content="2025-06-17T12:30:24+02:00"><meta itemprop=wordCount content="3949"><meta itemprop=keywords content="Java,Python"><meta property="og:url" content="https://azuar4e.github.io/es/posts/tdl/"><meta property="og:site_name" content="azuar4e"><meta property="og:title" content="Traductor de Lenguajes"><meta property="og:description" content="Un proyecto universitario de la asignatura Traductores de Lenguajes."><meta property="og:locale" content="es"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-17T12:30:24+02:00"><meta property="article:modified_time" content="2025-06-17T12:30:24+02:00"><meta property="article:tag" content="Java"><meta property="article:tag" content="Python"><meta name=twitter:card content="summary"><meta name=twitter:title content="Traductor de Lenguajes"><meta name=twitter:description content="Un proyecto universitario de la asignatura Traductores de Lenguajes."><meta name=twitter:site content="@azuar4e"><meta name=twitter:creator content="@azuar4e"><meta name=application-name content="azuar4e"><meta name=apple-mobile-web-app-title content="azuar4e"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://azuar4e.github.io/es/posts/tdl/ title="Traductor de Lenguajes - azuar4e"><link rel=prev type=text/html href=https://azuar4e.github.io/es/about/ title="Sobre mí"><link rel=next type=text/html href=https://azuar4e.github.io/es/posts/sos/ title="Servicio RESTful"><link rel=alternate type=text/markdown href=https://azuar4e.github.io/es/posts/tdl/index.md title="Traductor de Lenguajes - azuar4e"><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Traductor de Lenguajes","inLanguage":"es","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/azuar4e.github.io\/es\/posts\/tdl\/"},"genre":"posts","keywords":"Java, Python","wordcount":3949,"url":"https:\/\/azuar4e.github.io\/es\/posts\/tdl\/","datePublished":"2025-06-17T12:30:24+02:00","dateModified":"2025-06-17T12:30:24+02:00","publisher":{"@type":"Organization","name":"azuar4e","logo":"https:\/\/azuar4e.github.io\/images\/avatar.jpg"},"author":{"@type":"Person","name":"Angel Azuara Eizaguirre"},"description":"Un proyecto universitario de la asignatura Traductores de Lenguajes."}</script><script src=/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/es/ title=azuar4e><span class=header-title-text>azuar4e</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/es/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archivos</a></li><li class=menu-item><a class=menu-link href=/es/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categorías</a></li><li class=menu-item><a class=menu-link href=/es/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Etiquetas</a></li><li class=menu-item><a class=menu-link href=/es/about/><i class="fa-solid fa-quote-left fa-fw fa-sm" aria-hidden=true></i> Acerca de</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Busca títulos o contenido..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Buscar><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Limpiar><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Cambia el tema"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language-switch"><span role=button aria-label="Selecciona el lenguage" title="Selecciona el lenguage"><i class="fa-solid fa-language fa-fw" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a href=/en/posts/tdl/ class=menu-link title=English>English</a></li><li class=menu-item><span class=text-secondary title=Español>Español</span></li></ul></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/es/ title=azuar4e><span class=header-title-text>azuar4e</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Busca títulos o contenido..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Buscar><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Limpiar><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancelar</a></li><li class=menu-item><a class=menu-link href=/es/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archivos</a></li><li class=menu-item><a class=menu-link href=/es/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categorías</a></li><li class=menu-item><a class=menu-link href=/es/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Etiquetas</a></li><li class=menu-item><a class=menu-link href=/es/about/><i class="fa-solid fa-quote-left fa-fw fa-sm" aria-hidden=true></i> Acerca de</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Cambia el tema"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span><span class="menu-system-item language-switch">
<span role=button aria-label="Selecciona el lenguage" title="Selecciona el lenguage">Español<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option value=/en/posts/tdl/>English</option><option value=/es/posts/tdl/ selected disabled>Español</option></select></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><nav aria-label=breadcrumb class="breadcrumb-container sticky"><ol class=breadcrumb><li class=breadcrumb-item data-separator=/><a href=/es/posts/ title=Posts>Artículos</a></li><li class="breadcrumb-item active" data-separator=/ aria-current=page>Traductor De Lenguajes</li></ol></nav><main class=container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=Colecciones><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>Contenido relacionado</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/es/posts/sos/ title="Servicio RESTful">Servicio RESTful</a></li></ul></div></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Traductor De Lenguajes</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://www.linkedin.com/in/angel-azuara/ title=Autor target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=/images/avatar.jpg alt="Angel Azuara Eizaguirre" height=16 width=16>&nbsp;Angel Azuara Eizaguirre</a></span><span class=post-included-in>&nbsp;incluido en <a href=/es/categories/universidad/ class=post-category title="Categoría - Universidad"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Universidad</a>&ensp;<a href=/es/categories/proyectos-personales/ class=post-category title="Categoría - Proyectos Personales"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Proyectos Personales</a></span></div><div class=post-meta-line><span title="publicado el 2025-06-17 12:30:24"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-06-17>2025-06-17</time></span>&nbsp;<span title="3949 palabras"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>Aproximadamente 4000 palabras</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>19 minutos</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Contenido</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ol><li><a href=#introducción>Introducción</a></li><li><a href=#procesador-de-lenguajes>Procesador de Lenguajes</a><ol><li><a href=#analizador-léxico>Analizador léxico</a></li><li><a href=#analizador-sintáctico>Analizador sintáctico</a></li><li><a href=#analizador-semántico>Analizador semántico</a></li><li><a href=#generador-de-código-intermedio>Generador de código intermedio</a></li></ol></li><li><a href=#traductor-de-lenguajes>Traductor de lenguajes</a><ol><li><a href=#ficheros-empleados>Ficheros empleados</a></li><li><a href=#funcionamiento>Funcionamiento</a></li></ol></li><li><a href=#ejecución>Ejecución</a><ol><li><a href=#prerequisitos>Prerequisitos</a></li><li><a href=#descarga>Descarga</a></li><li><a href=#ensamblador>Ensamblador</a></li></ol></li><li><a href=#uso>Uso</a><ol><li><a href=#instalación-de-dependencias>Instalación de dependencias</a></li><li><a href=#compilación-del-procesador>Compilación del procesador</a></li><li><a href=#ejecución-del-procesador>Ejecución del procesador</a></li><li><a href=#ejecución-del-traductor>Ejecución del traductor</a></li><li><a href=#ejecución-del-código-objeto>Ejecución del código objeto</a></li></ol></li><li><a href=#herramientas>Herramientas</a></li><li><a href=#conclusión>Conclusión</a></li></ol></nav></div></div><div class=content id=content><h2 class=heading-element id=introducción><span>1 Introducción</span>
<a href=#introducci%c3%b3n class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>En este artículo explico el funcionamiento de un compilador, desde el procesamiento del fichero fuente hasta la traducción a código objeto. Este post está basado en un trabajo universitario para la asignatura <a href=https://dlsiis.fi.upm.es/traductores/index.html target=_blank rel="external nofollow noopener noreferrer">Traductores de Lenguajes</a>. Todo el código fuente está disponible en mi repositorio de GitHub (enlace al final, en la sección <a href=#herramientas>Herramientas</a>).</p><p>El traductor genera, a partir de un archivo de código escrito en el <a href=https://dlsiis.fi.upm.es/traductores/IntroBoreal.html target=_blank rel="external nofollow noopener noreferrer">Lenguaje Boreal</a>, previamente validado por el procesador, un archivo <code>.ens</code> con el <strong>código objeto</strong> del programa, escrito en el lenguaje <a href=https://dlsiis.fi.upm.es/traductores/Documentos/ENS2001.pdf target=_blank rel="external nofollow noopener noreferrer">ENS2001</a>.</p><p>El proyecto se divide en <strong>dos partes principales</strong>:</p><ul><li><strong>Procesador de lenguajes</strong>, escrito en <em>Java</em>, proporcionado por la asignatura y extendido por nosotros.</li><li><strong>Traductor de lenguajes</strong>, desarrollado desde cero en <em>Python</em>.</li></ul><blockquote><p><strong>Nota:</strong> Esta implementación solo cubre:</p><ul><li>Las sentencias IF-THEN e IF-THEN-ELSE.</li><li>El operador mínimo MIN.</li><li>Los procedimientos PROCEDURE con paso de parámetros por <em>valor</em> y por <em>referencia</em>.</li><li>Los operadores <code>*</code>, <code>AND</code> y <code>=</code> (comparación, <strong>no</strong> asignación).</li></ul><p>⚠️ El resto de operadores no están cubiertos.</p><p>⚠️ Tampoco se realiza ninguna optimización sobre el código objeto (ensamblador).
⚠️ <strong>Los materiales originales del Lenguaje Boreal y el procesador ENS2001 pueden no estar disponibles temporalmente.</strong>
Este post se centra en mi implementación del compilador, no en la distribución de los materiales originales. Si necesitas consultarlos, puedes intentar acceder más adelante o buscar versiones archivadas.</p></blockquote><h2 class=heading-element id=procesador-de-lenguajes><span>2 Procesador de Lenguajes</span>
<a href=#procesador-de-lenguajes class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>El procesador de lenguajes es el responsable de validar que un fichero fuente no tenga errores de tipo <strong>léxico</strong>, <strong>sintáctico</strong> o <strong>semántico</strong>.</p><p>Este módulo se divide en <strong>cuatro etapas</strong>:</p><ul><li><strong>Analizador léxico</strong></li><li><strong>Analizador sintáctico</strong></li><li><strong>Analizador semántico</strong></li><li><strong>Generador de código intermedio</strong>, que en realidad pertenece al traductor pero forma parte del código del procesador.</li></ul><hr><p>Antes de comenzar, es importante conocer los siguientes conceptos:</p><ul><li><strong>Tabla de símbolos</strong>: es la encargada de almacenar los identificadores de las variables, constantes, procedimientos, etc.</li></ul><p>E.g.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>TABLA PRINCIPAL #1:
</span></span><span class=line><span class=cl>*LEXEMA: &#39;S1&#39;
</span></span><span class=line><span class=cl>	Atributos:
</span></span><span class=line><span class=cl>	+ Tipo: &#39;cadena&#39;
</span></span><span class=line><span class=cl>	+ Despl: 4
</span></span><span class=line><span class=cl>	+ Param: 0
</span></span><span class=line><span class=cl>*LEXEMA: &#39;IMPRIME&#39;
</span></span><span class=line><span class=cl>	Atributos:
</span></span><span class=line><span class=cl>	+ Tipo: &#39;procedimiento&#39;
</span></span><span class=line><span class=cl>	+ numParam: 2
</span></span><span class=line><span class=cl>	+ TipoParam0: &#39;entero&#39;
</span></span><span class=line><span class=cl>	+ TipoParam1: &#39;entero&#39;
</span></span><span class=line><span class=cl>	+ ModoParam0: &#39;valor&#39;
</span></span><span class=line><span class=cl>	+ ModoParam1: &#39;valor&#39;
</span></span><span class=line><span class=cl>	+ TipoRetorno: &#39;-&#39;
</span></span><span class=line><span class=cl>	+ EtiqFuncion: &#39;EtiqProc2&#39;</span></span></code></pre></td></tr></table></div></div><ul><li><strong>Parse</strong>: es el encargado de almacenar el orden con el que se ejecutan las reglas de la gramática.</li></ul><p>E.g.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>ascendente  2 21 20 19 20 20 18 17 17 17 17 15 9 100 20 100 20 ...</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>ascendente</strong> indica el tipo de analizador sintáctico utilizado.</p></blockquote><ul><li><strong>Tokens</strong>: puede ser cualquier cosa: un <code>for</code>, un <code>;</code>, el nombre de una variable, etc. El archivo fuente es dividido en tokens, que son almacenados en otro fichero bajo este nombre.</li></ul><p>E.g.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&lt;VAR,-&gt;
</span></span><span class=line><span class=cl>&lt;ID,1&gt;
</span></span><span class=line><span class=cl>&lt;DOSPUNTOS,-&gt;
</span></span><span class=line><span class=cl>&lt;STRING,-&gt;
</span></span><span class=line><span class=cl>&lt;PYC,-&gt;
</span></span><span class=line><span class=cl>&lt;ID,2&gt;
</span></span><span class=line><span class=cl>&lt;DOSPUNTOS,-&gt;
</span></span><span class=line><span class=cl>...</span></span></code></pre></td></tr></table></div></div><ul><li>Por último, el <strong>tipo de procesador</strong>. En este caso, usamos uno <em>ascendente</em>, pero también existen <em>descendentes</em>, <em>descendentes con tablas</em>, etc.</li></ul><hr><h3 class=heading-element id=analizador-léxico><span>2.1 Analizador léxico</span>
<a href=#analizador-l%c3%a9xico class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Para los <strong>errores léxicos</strong>, utilizamos un <strong>autómata</strong> que recorre el fichero fuente carácter a carácter. A medida que se avanza, se van evaluando los estados del autómata y, si todo va bien, se genera un archivo de <strong>tokens</strong> como salida.</p><p>Si se encuentra algún símbolo que no encaja en el autómata, se considera un <strong>error léxico</strong>.</p><p>E.g. de un autómata:</p><p><a class=lightgallery href=/es/posts/tdl/images/automata.PNG title="Ejemplo de un autómata" data-thumbnail=/es/posts/tdl/images/automata.PNG data-sub-html="<h2>Ejemplo de un autómata</h2>"><img loading=lazy src=/es/posts/tdl/images/automata.PNG alt="Ejemplo de un autómata" height=209 width=557></a></p><p>Un caso típico de error léxico es una <strong>cadena sin cerrar</strong>. La siguiente imagen muestra un autómata que reconoce cadenas entre comillas:</p><p><a class=lightgallery href=/es/posts/tdl/images/image.png title="Autómata para una cadena" data-thumbnail=/es/posts/tdl/images/image.png data-sub-html="<h2>Autómata para una cadena</h2>"><img loading=lazy src=/es/posts/tdl/images/image.png alt="Autómata para una cadena" height=544 width=1785></a></p><p>Aquí, <code>C</code> representa cualquier carácter. Para alcanzar el estado final y reconocer una cadena correctamente, necesitamos que termine con un <code>"</code>.</p><p>También se consideran errores léxicos situaciones como:</p><ul><li>Una cadena que supera la longitud máxima permitida</li><li>Un número fuera de rango</li><li>Caracteres no válidos en el lenguaje</li></ul><p>Entre otros.</p><hr><h3 class=heading-element id=analizador-sintáctico><span>2.2 Analizador sintáctico</span>
<a href=#analizador-sint%c3%a1ctico class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Para los <strong>errores sintácticos</strong>, se analizan las estructuras del lenguaje mediante reglas gramaticales. Estos errores aparecen cuando la secuencia de tokens no sigue la sintaxis esperada. Aquí entra los conceptos de <strong>first</strong> y <strong>follow</strong>. Para explicarlos, mostramos un fragmento de una gramática:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Producciones = {
</span></span><span class=line><span class=cl>Pprima -&gt; P
</span></span><span class=line><span class=cl>P -&gt; B P
</span></span><span class=line><span class=cl>P -&gt; F P
</span></span><span class=line><span class=cl>P -&gt; lambda
</span></span><span class=line><span class=cl>B -&gt; var T id Bprima ;
</span></span><span class=line><span class=cl>B -&gt; S
</span></span><span class=line><span class=cl>B -&gt; if ( E ) W
</span></span><span class=line><span class=cl>B -&gt; lambda
</span></span><span class=line><span class=cl>W -&gt; id Sprima
</span></span><span class=line><span class=cl>W -&gt; output E ;
</span></span><span class=line><span class=cl>W -&gt; input id ;
</span></span><span class=line><span class=cl>W -&gt; return X ;
</span></span><span class=line><span class=cl>W -&gt; Begin C End J
</span></span><span class=line><span class=cl>J -&gt; else Begin C End
</span></span><span class=line><span class=cl>J -&gt; lambda
</span></span><span class=line><span class=cl>Bprima -&gt; = E
</span></span><span class=line><span class=cl>Bprima -&gt; lambda
</span></span><span class=line><span class=cl>S -&gt; id Sprima
</span></span><span class=line><span class=cl>S -&gt; output E ;
</span></span><span class=line><span class=cl>S -&gt; input id ;
</span></span><span class=line><span class=cl>S -&gt; return X ;
</span></span><span class=line><span class=cl>Sprima -&gt; = E ;
</span></span><span class=line><span class=cl>Sprima -&gt; ( L ) ;
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div><p>Un <strong>terminal</strong> es un símbolo que aparece tal cual en el lenguaje fuente (<code>;</code>, <code>if</code>, <code>var</code>&mldr;).<br>Un <strong>no terminal</strong> representa una regla o construcción de la gramática (<code>T</code>, <code>B</code>, <code>P</code>&mldr;).</p><ul><li><p>El conjunto <strong>first</strong> de un no terminal son todos los terminales con los que puede comenzar.<br>Por ejemplo, el <code>first(W)</code> sería: <code>id</code>, <code>output</code>, <code>input</code>, <code>return</code>, <code>{</code> (Begin).</p></li><li><p>El conjunto <strong>follow</strong> de un no terminal son los terminales que pueden aparecer <strong>justo después</strong> de él en una derivación.<br>Por ejemplo, si <code>X</code> siempre va seguido de <code>;</code>, entonces <code>follow(X) = { ; }</code>.</p></li></ul><p>Si una regla puede derivar en <strong>lambda</strong> (vacío), su <code>follow</code> también incluye lo que podría venir tras ese punto en la producción.<br>e.g. en <code>P → B P</code> y <code>P → lambda</code>, como <code>P</code> puede ser vacío, <code>follow(B)</code> incluye lo que sigue a <code>P</code>, e incluso el símbolo de fin <code>$</code>.</p><p>Un <strong>error sintáctico</strong> se produce cuando el token actual <strong>no pertenece al conjunto <code>first</code></strong> de la regla esperada.<br>Por ejemplo, si se espera una producción de <code>W</code> y el siguiente token es <code>if</code> (que no está en <code>first(W)</code>), se trata de un error.</p><blockquote><p>Ejemplo típico: un <code>else</code> sin su <code>if</code>, o una expresión mal cerrada.</p></blockquote><hr><h3 class=heading-element id=analizador-semántico><span>2.3 Analizador semántico</span>
<a href=#analizador-sem%c3%a1ntico class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Para los <strong>errores semánticos</strong>, utilizamos <strong>acciones semánticas</strong>, en las que se definen cosas como:</p><ul><li>Herencia de atributos</li><li>Inserciones en la tabla de símbolos</li><li>Validaciones de tipos</li></ul><p>Por ejemplo, en una regla como <code>W → output E ;</code>, podríamos tener una acción semántica del estilo <code>{ W.tipo := E.tipo }</code>, que asigna a <code>W</code> el tipo de <code>E</code>.<br>En el código, esto se reflejaría evaluando ese caso y actualizando la pila de atributos.</p><p>Un error semántico típico sería que el tipo heredado no coincida con el esperado.</p><hr><h3 class=heading-element id=generador-de-código-intermedio><span>2.4 Generador de código intermedio</span>
<a href=#generador-de-c%c3%b3digo-intermedio class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Volviendo al traductor, el generador de código intermedio es una extensión del procesador en la que definimos nuevas acciones semánticas para poder generar el fichero con el <strong>código intermedio</strong>, en este caso, en el formato de un <a href=https://dlsiis.fi.upm.es/traductores/Documentos/formato_fichero_cuartetos.pdf target=_blank rel="external nofollow noopener noreferrer">fichero de cuartetos</a> definido por la asignatura.</p><p>Para esto, en nuestra implementación definimos <em>2 nuevas clases</em>, <code>gci.java</code> y <code>cuarteto.java</code>.</p><p>En la primera definimos las siguientes funciones:</p><p><code>emite</code>, que es la que genera los cuartetos:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>cuarteto</span><span class=w> </span><span class=nf>emite</span><span class=w> </span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>operador</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>arg1</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>arg2</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>resultado</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>cuarteto</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>cuarteto</span><span class=p>(</span><span class=n>operador</span><span class=p>,</span><span class=w> </span><span class=n>arg1</span><span class=p>,</span><span class=w> </span><span class=n>arg2</span><span class=p>,</span><span class=w> </span><span class=n>resultado</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>printCuarteto</span><span class=p>(</span><span class=n>c</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>c</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p><code>nuevatemp</code>, que crea una nueva variable temporal del tipo especificado y la inserta en la tabla de símbolos:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>tupla</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=nf>nuevatemp</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>tipo</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>nuevatemp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;t&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>conttemp</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>conttemp</span><span class=o>++</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>ASem</span><span class=p>.</span><span class=na>tsGlobal</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Integer</span><span class=w> </span><span class=n>pos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>addEntradaTSGlobal</span><span class=p>(</span><span class=n>nuevatemp</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>tipo</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=s>&#34;tipo_error&#34;</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>setTipo</span><span class=p>(</span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=n>tipo</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>setTipo</span><span class=p>(</span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=n>tipo</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>setValorAtributoEnt</span><span class=p>(</span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=s>&#34;desplazamiento&#34;</span><span class=p>,</span><span class=w> </span><span class=n>ASem</span><span class=p>.</span><span class=na>despGlobal</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>tupla</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>tupla</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>tupla</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=s>&#34;VAR_GLOBAL&#34;</span><span class=p>,</span><span class=w> </span><span class=n>ASem</span><span class=p>.</span><span class=na>despLocal</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>switch</span><span class=w> </span><span class=p>(</span><span class=n>tipo</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=s>&#34;lógico&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ASem</span><span class=p>.</span><span class=na>despGlobal</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=s>&#34;entero&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ASem</span><span class=p>.</span><span class=na>despGlobal</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=s>&#34;cadena&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ASem</span><span class=p>.</span><span class=na>despGlobal</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>64</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>tupla</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Integer</span><span class=w> </span><span class=n>pos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>addEntradaTSLocal</span><span class=p>(</span><span class=n>nuevatemp</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>tipo</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=s>&#34;tipo_error&#34;</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>setTipo</span><span class=p>(</span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=n>tipo</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>setTipo</span><span class=p>(</span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=n>tipo</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>setValorAtributoEnt</span><span class=p>(</span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=s>&#34;desplazamiento&#34;</span><span class=p>,</span><span class=w> </span><span class=n>ASem</span><span class=p>.</span><span class=na>despLocal</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>tupla</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>tupla</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>tupla</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=s>&#34;VAR_LOCAL&#34;</span><span class=p>,</span><span class=w> </span><span class=n>ASem</span><span class=p>.</span><span class=na>despLocal</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>switch</span><span class=w> </span><span class=p>(</span><span class=n>tipo</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=s>&#34;lógico&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ASem</span><span class=p>.</span><span class=na>despLocal</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=s>&#34;entero&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ASem</span><span class=p>.</span><span class=na>despLocal</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=s>&#34;cadena&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ASem</span><span class=p>.</span><span class=na>despLocal</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>64</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>tupla</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p><code>nuevaetiq</code>, que crea una nueva etiqueta utilizada para los saltos condicionales e incondicionales:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>tupla</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=nf>nuevaetiq</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>nombre</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>nuevaetiq</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>nombre</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>nuevaetiq</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Etiq&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>contetiq</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>contetiq</span><span class=o>++</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>nuevaetiq</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>nombre</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tupla</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>tupla</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>tupla</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=s>&#34;ET&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nuevaetiq</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>tupla</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>En la clase <code>cuarteto</code> definimos el objeto <strong>cuarteto</strong> y un método <code>toString</code> para su representación:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=nf>cuarteto</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>operador</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>arg1</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>arg2</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=n>resultado</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>this</span><span class=p>.</span><span class=na>operador</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>operador</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>this</span><span class=p>.</span><span class=na>arg1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>arg1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>this</span><span class=p>.</span><span class=na>arg2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>arg2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>this</span><span class=p>.</span><span class=na>resultado</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>resultado</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><hr><p>En cuanto a las acciones semánticas para la generación de código intermedio, se definen en la clase <code>ASem.java</code> junto a las acciones del propio analizador semántico.</p><p>A continuación un fragmento de código para la acción <code>processRule(94, "Z -> id LL");</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>llAtb</span><span class=p>.</span><span class=na>getLongs</span><span class=p>()</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>idTipo</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=s>&#34;procedimiento&#34;</span><span class=p>)){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>gci</span><span class=p>.</span><span class=na>emite</span><span class=p>(</span><span class=s>&#34;CALL&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>getValorAtributoCad</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;etiqueta&#34;</span><span class=p>),</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>paramRef2</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>())</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>paramRef2</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>()).</span><span class=na>equals</span><span class=p>(</span><span class=s>&#34;referencia&#34;</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=n>res</span><span class=p>.</span><span class=na>setReferencia</span><span class=p>(</span><span class=s>&#34;referencia&#34;</span><span class=p>);}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>identificadores</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>())</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>res</span><span class=p>.</span><span class=na>setLugar</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>gci</span><span class=p>.</span><span class=na>tupla</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=s>&#34;VAR_LOCAL&#34;</span><span class=p>,</span><span class=w> </span><span class=n>procesador</span><span class=p>.</span><span class=na>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>getValorAtributoEnt</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;desplazamiento&#34;</span><span class=p>)));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>identificadores</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>()))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>res</span><span class=p>.</span><span class=na>setLugar</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>gci</span><span class=p>.</span><span class=na>tupla</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=s>&#34;VAR_GLOBAL&#34;</span><span class=p>,</span><span class=w> </span><span class=n>procesador</span><span class=p>.</span><span class=na>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>getValorAtributoEnt</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;desplazamiento&#34;</span><span class=p>)));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>res</span><span class=p>.</span><span class=na>setLugar</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>gci</span><span class=p>.</span><span class=na>tupla</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=s>&#34;VAR_LOCAL&#34;</span><span class=p>,</span><span class=w> </span><span class=n>procesador</span><span class=p>.</span><span class=na>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>getValorAtributoEnt</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;desplazamiento&#34;</span><span class=p>)));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>LinkedList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>referencias</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>paramRef</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>LinkedList</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>tipos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>paramTipo</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>llAtb</span><span class=p>.</span><span class=na>getLongs</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>--</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>referencias</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>tipos</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>i</span><span class=p>).</span><span class=na>equals</span><span class=p>(</span><span class=s>&#34;cadena&#34;</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>gci</span><span class=p>.</span><span class=na>emite</span><span class=p>(</span><span class=s>&#34;PARAM_CAD&#34;</span><span class=p>,</span><span class=w> </span><span class=n>llAtb</span><span class=p>.</span><span class=na>getParam</span><span class=p>(</span><span class=n>i</span><span class=p>),</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>gci</span><span class=p>.</span><span class=na>emite</span><span class=p>(</span><span class=s>&#34;PARAM&#34;</span><span class=p>,</span><span class=w> </span><span class=n>llAtb</span><span class=p>.</span><span class=na>getParam</span><span class=p>(</span><span class=n>i</span><span class=p>),</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>tipos</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>i</span><span class=p>).</span><span class=na>equals</span><span class=p>(</span><span class=s>&#34;cadena&#34;</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>gci</span><span class=p>.</span><span class=na>emite</span><span class=p>(</span><span class=s>&#34;PARAM_REF_CAD&#34;</span><span class=p>,</span><span class=w> </span><span class=n>llAtb</span><span class=p>.</span><span class=na>getParam</span><span class=p>(</span><span class=n>i</span><span class=p>),</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>gci</span><span class=p>.</span><span class=na>emite</span><span class=p>(</span><span class=s>&#34;PARAM_REF&#34;</span><span class=p>,</span><span class=w> </span><span class=n>llAtb</span><span class=p>.</span><span class=na>getParam</span><span class=p>(</span><span class=n>i</span><span class=p>),</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>String</span><span class=w> </span><span class=n>ret</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>getValorAtributoCad</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;tipoRetorno&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>switch</span><span class=p>(</span><span class=n>ret</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>case</span><span class=w> </span><span class=s>&#34;entero&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>gci</span><span class=p>.</span><span class=na>emite</span><span class=p>(</span><span class=s>&#34;CALL_FUN&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>getValorAtributoCad</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;etiqueta&#34;</span><span class=p>),</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>res</span><span class=p>.</span><span class=na>getLugar</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>case</span><span class=w> </span><span class=s>&#34;cadena&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>gci</span><span class=p>.</span><span class=na>emite</span><span class=p>(</span><span class=s>&#34;CALL_FUN_CAD&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>getValorAtributoCad</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;etiqueta&#34;</span><span class=p>),</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>res</span><span class=p>.</span><span class=na>getLugar</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>default</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>gci</span><span class=p>.</span><span class=na>emite</span><span class=p>(</span><span class=s>&#34;CALL&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Procesador</span><span class=p>.</span><span class=na>gestorTS</span><span class=p>.</span><span class=na>getValorAtributoCad</span><span class=p>(</span><span class=n>idAtb</span><span class=p>.</span><span class=na>getPos</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;etiqueta&#34;</span><span class=p>),</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>La acción semántica se divide en dos ramas:</p><ol><li><p><strong>Si no hay parámetros (<code>llAtb.getLongs() == 0</code>)</strong>:</p><ul><li>Si <code>id</code> es un procedimiento → emitir <code>CALL</code>.</li><li>Si es una variable → crear tupla con su ámbito (local o global) y desplazamiento en la tabla de símbolos, y asignarlo a <code>res.setLugar()</code> para que se herede por el resto del arbol y sea accesible en otras reglas.</li></ul></li><li><p><strong>Si hay parámetros</strong>:</p><ul><li>Emitir los parámetros uno a uno según tipo y paso por valor/referencia.</li><li>Emitir <code>CALL_FUN</code>, <code>CALL_FUN_CAD</code> o <code>CALL</code> según el tipo de retorno. En este caso solo puede ser <code>CALL</code> ya que el traductor está diseñado únicamente para procedimientos (sin valor de retorno).</li></ul></li></ol><blockquote><p><code>res</code> es un objeto de la clase atributos y es lo que retorna el método de la acción. Las acciones también reciben objetos de la clase atributos que se obtienen desde la pila de atributos del analizador semántico.</p></blockquote><hr><h2 class=heading-element id=traductor-de-lenguajes><span>3 Traductor de lenguajes</span>
<a href=#traductor-de-lenguajes class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>Una vez validado el archivo fuente, se nos generan los archivos <code>tokens.txt</code>, <code>parse.txt</code>, <code>errores.txt</code>, <code>ts.txt</code> y adicionalmente, el archivo <code>cuartetos.txt</code>. A continuación, el <strong>generador de código objeto</strong>, en base al <em>fichero de cuartetos</em>, genera un archivo <code>.ens</code>.</p><p>Como hemos hecho con anterioridad, antes de adentrarnos en el código debemos saber:</p><p>Que un <strong>registro de activación</strong> (RA) es una zona de memoria consecutiva en la que se almacena la información de activación de un subprograma (cada uno tiene el suyo propio).</p><p><a class=lightgallery href=/es/posts/tdl/images/image1.png title="Registro de Activación" data-thumbnail=/es/posts/tdl/images/image1.png data-sub-html="<h2>Registro de Activación</h2>"><img loading=lazy src=/es/posts/tdl/images/image1.png alt="Registro de Activación" height=273 width=270></a></p><ul><li><p>El <strong>estado de la máquina</strong> (EM) es el estado antes de llamar a un subprograma.</p></li><li><p>El <strong>puntero de control</strong> (pc) apunta al RA del subprograma llamador. Se usa al finalizar el subprograma.</p></li><li><p>El <strong>puntero de acceso</strong> (pa) apunta al registro de activacion del subprograma donde está declarado el subprograma actual. Si <code>b</code> esta definido en <code>a</code>, el pa de <code>b</code> apunta a <code>a</code>. Se utiliza para acceder a variables no locales cuando hay anidamiento de funciones.</p></li></ul><hr><h3 class=heading-element id=ficheros-empleados><span>3.1 Ficheros empleados</span>
<a href=#ficheros-empleados class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>En esta implementación hacemos uso de tres ficheros:</p><ul><li><strong><code>_ens.py</code></strong>: maneja la creación y escritura del archivo <code>.ens</code>.</li><li><strong><code>_gco.py</code></strong>: archivo principal; traduce cada cuarteto a instrucciones <code>.ens</code>.</li><li><strong><code>_calcprev.py</code></strong>: calcula tamaños de RA&rsquo;s y zona de datos estáticos (globales).</li></ul><h3 class=heading-element id=funcionamiento><span>3.2 Funcionamiento</span>
<a href=#funcionamiento class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><code>_ens.py</code>: este módulo contiene una única función que abre el archivo <code>.ens</code> en <strong>modo escritura</strong> y añade líneas según sea necesario:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>archivo</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>escribir</span><span class=p>(</span><span class=n>linea</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>archivo</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>archivo</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>archivo</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;codobj.ens&#34;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>archivo</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>linea</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p><code>_calcprev.py</code>: Este script recorre la tabla de símbolos (<code>ts.txt</code>) para calcular:</p><ul><li><p>El tamaño de la <strong>zona de datos estáticos</strong>.</p></li><li><p>Los tamaños de cada <strong>registro de activación</strong> (RA).</p></li><li><p>Las <strong>referencias</strong> necesarias para parámetros por referencia.</p></li></ul><p>Utilizamos <em>dos funciones auxiliares</em>, una para leer cada línea de la tabla de símbolos y otra para obtener el tamaño de cada tipo.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>leer</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>archivo</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>archivo</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>archivo</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;ts.txt&#34;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>archivo</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>reserva</span><span class=p>(</span><span class=n>tipo</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>tipo</span> <span class=o>==</span> <span class=s1>&#39;entero&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>tipo</span> <span class=o>==</span> <span class=s1>&#39;logico&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>tipo</span> <span class=o>==</span> <span class=s1>&#39;cadena&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>64</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span></span></span></code></pre></td></tr></table></div></div><p>Luego en el <code>main()</code> hacemos un bucle que:</p><ol><li><p>Lee línea a línea la tabla de símbolos.</p></li><li><p>Para la <strong>tabla local</strong>:</p><ul><li><strong>Calcular</strong> el tamaño del RA sumando los tamaños obtenidos con <code>reserva(...)</code>.</li><li><strong>Registrar</strong> los desplazamientos de los parámetros pasados por referencia.</li></ul></li><li><p>Para la <strong>tabla global</strong>:</p><ul><li><p><strong>Suma</strong> tamaños de variables globales.</p></li><li><p><strong>Suma</strong> el tamaño del retorno si es una funciones/procedimientos.</p></li></ul></li><li><p>Finalmente, genera las directivas de inicio de memoria y las etiquetas <code>EQU</code> para cada RA:</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>cadfinal</span>
</span></span><span class=line><span class=cl>    <span class=n>linea</span> <span class=o>=</span> <span class=n>leer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>tamestaticos</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>ras</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>linea</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>locales</span><span class=p>,</span> <span class=n>linea</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>coleccion</span><span class=p>[</span><span class=sa>f</span><span class=s2>&#34;ra</span><span class=si>{</span><span class=n>ras</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>            <span class=n>desp</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=n>linea</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=o>!=</span> <span class=n>separador</span><span class=o>.</span><span class=n>strip</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>lexema</span><span class=p>,</span> <span class=n>linea</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=k>while</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>tipo</span><span class=p>,</span> <span class=n>linea</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                        <span class=n>linea</span> <span class=o>=</span> <span class=n>leer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=n>desp</span> <span class=o>+=</span> <span class=n>reserva</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>tipo</span><span class=p>,</span> <span class=n>linea</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                    <span class=n>linea</span> <span class=o>=</span> <span class=n>leer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=n>d</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>de</span><span class=p>,</span> <span class=n>linea</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>linea</span> <span class=o>=</span> <span class=n>leer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=n>p</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>pr</span><span class=p>,</span> <span class=n>linea</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>p</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>if</span> <span class=n>referencias</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;ra</span><span class=si>{</span><span class=n>ras</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                            <span class=n>referencias</span><span class=p>[</span><span class=sa>f</span><span class=s2>&#34;ra</span><span class=si>{</span><span class=n>ras</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>                        <span class=n>referencias</span><span class=p>[</span><span class=sa>f</span><span class=s2>&#34;ra</span><span class=si>{</span><span class=n>ras</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>d</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>linea</span> <span class=o>=</span> <span class=n>leer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>coleccion</span><span class=p>[</span><span class=sa>f</span><span class=s2>&#34;ra</span><span class=si>{</span><span class=n>ras</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>desp</span>
</span></span><span class=line><span class=cl>            <span class=n>ras</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>globales</span><span class=p>,</span> <span class=n>linea</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>rasaux</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=n>linea</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>lexema</span><span class=p>,</span> <span class=n>linea</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=k>while</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>tipo</span><span class=p>,</span> <span class=n>linea</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                        <span class=n>linea</span> <span class=o>=</span> <span class=n>leer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=n>t</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>tipo</span><span class=p>,</span> <span class=n>linea</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>t</span> <span class=o>!=</span> <span class=s1>&#39;funcion&#39;</span> <span class=ow>and</span> <span class=n>t</span> <span class=o>!=</span> <span class=s1>&#39;procedimiento&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>tamestaticos</span> <span class=o>+=</span> <span class=n>reserva</span><span class=p>(</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>while</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>retorno</span><span class=p>,</span> <span class=n>linea</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                            <span class=n>linea</span> <span class=o>=</span> <span class=n>leer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                        <span class=n>aux</span> <span class=o>=</span> <span class=n>coleccion</span><span class=p>[</span><span class=sa>f</span><span class=s2>&#34;ra</span><span class=si>{</span><span class=n>rasaux</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                        <span class=n>aux</span> <span class=o>+=</span> <span class=n>reserva</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>retorno</span><span class=p>,</span> <span class=n>linea</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                        <span class=n>coleccion</span><span class=p>[</span><span class=sa>f</span><span class=s2>&#34;ra</span><span class=si>{</span><span class=n>rasaux</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>aux</span>
</span></span><span class=line><span class=cl>                        <span class=n>rasaux</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>linea</span> <span class=o>=</span> <span class=n>leer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>linea</span> <span class=o>=</span> <span class=n>leer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cadfinal</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>tamestaticos</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cadfinal</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=s2>inicio_estaticas: RES </span><span class=si>{</span><span class=n>tamestaticos</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>cadfinal</span> <span class=o>+=</span> <span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=s2>inicio_pila: NOP</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>tamestaticos</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>escribir</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=s2>MOVE #inicio_estaticas, .IY</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>escribir</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=s2>MOVE #inicio_pila, .IX</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># generamos las etiquetas para los registros de activacion</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>ra</span> <span class=ow>in</span> <span class=n>coleccion</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>escribir</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=si>{</span><span class=n>ra</span><span class=si>}</span><span class=s2>: EQU </span><span class=si>{</span><span class=n>coleccion</span><span class=p>[</span><span class=n>ra</span><span class=p>]</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>escribir</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n\t\t\t</span><span class=s2>BR /main</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>Nota:</strong> La variable <code>cadfinal</code> no se escribe aquí porque su contenido se añade al final del fichero <code>.ens</code>.</p></blockquote><p>Por último tenemos <code>_gco.py</code>, el archivo principal. A continuación pongo un extracto para entender su funcionamiento:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>patron_mul</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>\(MUL,\s*
</span></span></span><span class=line><span class=cl><span class=s2>    ((?:\{[^</span><span class=si>{}</span><span class=s2>]*\}|[^,()])+)  ,\s*
</span></span></span><span class=line><span class=cl><span class=s2>    ((?:\{[^</span><span class=si>{}</span><span class=s2>]*\}|[^,()])+)  ,\s*
</span></span></span><span class=line><span class=cl><span class=s2>    ((?:\{[^</span><span class=si>{}</span><span class=s2>]*\}|[^,()])+) 
</span></span></span><span class=line><span class=cl><span class=s2>\)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>patron_and</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>\(AND,\s*
</span></span></span><span class=line><span class=cl><span class=s2>    ((?:\{[^</span><span class=si>{}</span><span class=s2>]*\}|[^,()])+)  ,\s*
</span></span></span><span class=line><span class=cl><span class=s2>    ((?:\{[^</span><span class=si>{}</span><span class=s2>]*\}|[^,()])+)  ,\s*
</span></span></span><span class=line><span class=cl><span class=s2>    ((?:\{[^</span><span class=si>{}</span><span class=s2>]*\}|[^,()])+) 
</span></span></span><span class=line><span class=cl><span class=s2>\)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>patron_asig</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>\(ASIG,\s*
</span></span></span><span class=line><span class=cl><span class=s2>    ((?:\{[^</span><span class=si>{}</span><span class=s2>]*\}|[^,()])+)  ,\s*
</span></span></span><span class=line><span class=cl><span class=s2>    ((?:\{[^</span><span class=si>{}</span><span class=s2>]*\}|[^,()])+)  ,\s*
</span></span></span><span class=line><span class=cl><span class=s2>    ((?:\{[^</span><span class=si>{}</span><span class=s2>]*\}|[^,()])+) 
</span></span></span><span class=line><span class=cl><span class=s2>\)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span></span></span></code></pre></td></tr></table></div></div><p>Tenemos una sección con los patrones para detectar cada posible cuarteto, para esto hacemos uso de la librería <code>re</code>.</p><p>También usamos estos patrones para extraer desplazamientos, nombres, espacios y detectar el programa principal.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;</span><span class=se>\&#34;</span><span class=s2>\s*</span><span class=se>\&#34;</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ptloc</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;{VAR_LOCAL, (.+)}&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ptglob</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;{VAR_GLOBAL, (.+)}&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ptp</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;EtiqProc(\d+)&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ptf</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;EtiqFunc(\d+)&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ptm</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;main&#34;</span></span></span></code></pre></td></tr></table></div></div><p>En cuanto a las funciones, utilizamos las siguientes:</p><ul><li><code>leer</code>: utilizada para leer cada cuarteto.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>leer</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>archivo</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>archivo</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>archivo</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;cuartetos.txt&#34;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>archivo</span><span class=o>.</span><span class=n>readline</span><span class=p>()</span></span></span></code></pre></td></tr></table></div></div><ul><li><code>declarar_cads</code>: nos permite declarar los literales de cadenas al final del fichero de salida. Al final del bucle principal, llamamos a esta funcion con el atributo <code>cadena</code> None y <code>write</code> como <code>True</code>.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>declarar_cads</span><span class=p>(</span><span class=n>cadena</span><span class=p>,</span> <span class=n>write</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>cads</span><span class=p>,</span> <span class=n>cds</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>cadena</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=n>cadena</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cads</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>cads</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>cadena</span><span class=si>{</span><span class=n>cds</span><span class=si>}</span><span class=s2>:</span><span class=se>\t</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=n>cadena</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>cads</span> <span class=o>=</span> <span class=n>cads</span> <span class=o>+</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>cadena</span><span class=si>{</span><span class=n>cds</span><span class=si>}</span><span class=s2>:</span><span class=se>\t</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=n>cadena</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>write</span> <span class=ow>and</span> <span class=n>cads</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cads</span> <span class=o>+=</span> <span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>escribir</span><span class=p>(</span><span class=n>cads</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span></span></span></code></pre></td></tr></table></div></div><ul><li><code>leer_cadena_ens</code>: con esta función podemos pasar caracter a caracter la cadena declarada a un registro, o de un registro a otro. Esto es fundamental ya que a diferencia de con los enteros, para las cadenas tenemos que mover todo su contenido caracter a caracter.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>leer_cadena_ens</span><span class=p>(</span><span class=n>cadena</span><span class=p>,</span> <span class=n>escad</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>bucles</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>escad</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>codobj</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            MOVE #</span><span class=si>{</span><span class=n>cadena</span><span class=si>}</span><span class=s2>, .R7
</span></span></span><span class=line><span class=cl><span class=s2>            DEC .R2
</span></span></span><span class=line><span class=cl><span class=s2>            DEC .R7
</span></span></span><span class=line><span class=cl><span class=s2>bucle</span><span class=si>{</span><span class=n>bucles</span><span class=si>}</span><span class=s2>:	    INC .R2
</span></span></span><span class=line><span class=cl><span class=s2>            INC .R7
</span></span></span><span class=line><span class=cl><span class=s2>            MOVE [.R7], [.R2]
</span></span></span><span class=line><span class=cl><span class=s2>            CMP [.R7], #0
</span></span></span><span class=line><span class=cl><span class=s2>            BNZ $bucle</span><span class=si>{</span><span class=n>bucles</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>codobj</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            DEC .R3
</span></span></span><span class=line><span class=cl><span class=s2>            DEC .R2
</span></span></span><span class=line><span class=cl><span class=s2>bucle</span><span class=si>{</span><span class=n>bucles</span><span class=si>}</span><span class=s2>:	    INC .R3
</span></span></span><span class=line><span class=cl><span class=s2>            INC .R2
</span></span></span><span class=line><span class=cl><span class=s2>            MOVE [.R2], [.R3]
</span></span></span><span class=line><span class=cl><span class=s2>            CMP [.R2], #0
</span></span></span><span class=line><span class=cl><span class=s2>            BNZ $bucle</span><span class=si>{</span><span class=n>bucles</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>bucles</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>escribir</span><span class=p>(</span><span class=n>codobj</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><ul><li><code>paramcad</code>: análoga a la anterior, esta se usa únicamente cuando el parámetro de un subprograma es una cadena.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>paramcad</span><span class=p>(</span><span class=n>des</span><span class=p>,</span> <span class=n>desra</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>bucles</span>
</span></span><span class=line><span class=cl>    <span class=n>codobj</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            ADD #</span><span class=si>{</span><span class=n>des</span><span class=si>}</span><span class=s2>, .IX
</span></span></span><span class=line><span class=cl><span class=s2>            MOVE .A, .R2
</span></span></span><span class=line><span class=cl><span class=s2>            ADD #</span><span class=si>{</span><span class=n>desra</span><span class=si>}</span><span class=s2>, .IX
</span></span></span><span class=line><span class=cl><span class=s2>            MOVE .A, .R3
</span></span></span><span class=line><span class=cl><span class=s2>            DEC .R3
</span></span></span><span class=line><span class=cl><span class=s2>            DEC .R2
</span></span></span><span class=line><span class=cl><span class=s2>bucle</span><span class=si>{</span><span class=n>bucles</span><span class=si>}</span><span class=s2>:	    INC .R3
</span></span></span><span class=line><span class=cl><span class=s2>            INC .R2
</span></span></span><span class=line><span class=cl><span class=s2>            MOVE [.R2], [.R3]
</span></span></span><span class=line><span class=cl><span class=s2>            CMP [.R2], #0
</span></span></span><span class=line><span class=cl><span class=s2>            BNZ $bucle</span><span class=si>{</span><span class=n>bucles</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>bucles</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>escribir</span><span class=p>(</span><span class=n>codobj</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><ul><li><code>transformar_dir</code>: encargada de mover las direcciones de memoria pasadas como parámetros a los registros correspondientes. Estas pueden ser entre una y tres. Básicamente, recibe algo como <code>{VAR_GLOBAL, 3}</code> y esto mueve lo que hay en la dirección <code>#3[.IY]</code> a un registro como <code>R2</code>. Esto porque es global, si fuera local sería <code>#3[.IX]</code>.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>transformar_dir</span><span class=p>(</span><span class=n>dir1</span><span class=p>,</span> <span class=n>dir2</span><span class=p>,</span> <span class=n>dir3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ptglob</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;{VAR_GLOBAL, (.+)}&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>ptloc</span> <span class=o>=</span> <span class=sa>r</span><span class=s2>&#34;{VAR_LOCAL, (.+)}&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>nreg</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>    <span class=n>escribir</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nb>dir</span> <span class=ow>in</span> <span class=p>[</span><span class=n>dir1</span><span class=p>,</span> <span class=n>dir2</span><span class=p>,</span> <span class=n>dir3</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>dir</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>ptglob</span><span class=p>,</span> <span class=nb>dir</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>cad</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=s2>ADD #</span><span class=si>{</span><span class=n>re</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=n>ptglob</span><span class=p>,</span> <span class=nb>dir</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=si>}</span><span class=s2>, .IY</span><span class=se>\n\t\t\t</span><span class=s2>MOVE .A, .R</span><span class=si>{</span><span class=n>nreg</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>nreg</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>escribir</span><span class=p>(</span><span class=n>cad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>ptloc</span><span class=p>,</span> <span class=nb>dir</span><span class=p>):</span> <span class=c1># al ser local se le suma el tamaño del EM y PA</span>
</span></span><span class=line><span class=cl>            <span class=n>desp</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>ptloc</span><span class=p>,</span> <span class=nb>dir</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>cad</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=s2>ADD #</span><span class=si>{</span><span class=n>desp</span><span class=si>}</span><span class=s2>, .IX</span><span class=se>\n\t\t\t</span><span class=s2>MOVE .A, .R</span><span class=si>{</span><span class=n>nreg</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>raact</span> <span class=ow>in</span> <span class=n>_calcprev</span><span class=o>.</span><span class=n>referencias</span> <span class=ow>and</span> <span class=n>desp</span> <span class=ow>in</span> <span class=n>_calcprev</span><span class=o>.</span><span class=n>referencias</span><span class=p>[</span><span class=n>raact</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>cad</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=s2>MOVE [.R</span><span class=si>{</span><span class=n>nreg</span><span class=si>}</span><span class=s2>], .R</span><span class=si>{</span><span class=n>nreg</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=n>nreg</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>escribir</span><span class=p>(</span><span class=n>cad</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>escribir</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>Por último, el buble principal, que es el encargado de llamar a las funciones anteriores, y de iterar sobre cada cuarteto recibido. Dado que este bucle ocupa 600 líneas, pongo el comienzo para que se vea claro su funcionamiento.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>cds</span><span class=p>,</span> <span class=n>contador_llamadas</span><span class=p>,</span> <span class=n>primeraetiq</span><span class=p>,</span> <span class=n>contparam</span><span class=p>,</span> <span class=n>where</span><span class=p>,</span> <span class=n>contmin</span><span class=p>,</span> <span class=n>param_min</span><span class=p>,</span> <span class=n>raact</span><span class=p>,</span> <span class=n>esetiq</span>
</span></span><span class=line><span class=cl>    <span class=n>_calcprev</span><span class=o>.</span><span class=n>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>linea</span> <span class=o>=</span> <span class=n>leer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>linea</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>patron_mul</span><span class=p>,</span> <span class=n>linea</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>VERBOSE</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>esetiq</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>            <span class=n>coincidencia</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>patron_mul</span><span class=p>,</span> <span class=n>linea</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>VERBOSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>transformar_dir</span><span class=p>(</span><span class=n>coincidencia</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span> <span class=n>coincidencia</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=n>coincidencia</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>3</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>cadena</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=s2>MUL [.R2], [.R3]</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>escribir</span><span class=p>(</span><span class=n>cadena</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>cadena</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=s2>MOVE .A, [.R4]</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>escribir</span><span class=p>(</span><span class=n>cadena</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>patron_and</span><span class=p>,</span> <span class=n>linea</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>VERBOSE</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>esetiq</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>            <span class=n>coincidencia</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>patron_and</span><span class=p>,</span> <span class=n>linea</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>VERBOSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>transformar_dir</span><span class=p>(</span><span class=n>coincidencia</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span> <span class=n>coincidencia</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=n>coincidencia</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>3</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>cadena</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=s2>AND .R2, .R3&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>escribir</span><span class=p>(</span><span class=n>cadena</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>escribir</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>cadena</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=se>\t\t\t</span><span class=s2>MOVE .A, .R4&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>escribir</span><span class=p>(</span><span class=n>cadena</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>escribir</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><p>Como se puede observar, es un bucle muy sencillo en el que vamos evaluando cada caso y generando el código objeto correspondiente.</p><hr><h2 class=heading-element id=ejecución><span>4 Ejecución</span>
<a href=#ejecuci%c3%b3n class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>En esta sección se explica cómo ejecutar el código generado por el traductor, y se prueban diferentes ejemplos para entender su funcionamiento.</p><blockquote><p><strong>Nota:</strong> Solo se cubre la explicación para Windows, ya que en Linux el ensamblador no tiene interfaz y resulta menos didáctico.</p></blockquote><h3 class=heading-element id=prerequisitos><span>4.1 Prerequisitos</span>
<a href=#prerequisitos class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><ol><li>Asegurarse de que se haya compilado el proyecto (ver sección <a href=#uso>Uso</a>).</li><li>Fichero <code>codobj.ens</code> generado (código objeto).</li></ol><h3 class=heading-element id=descarga><span>4.2 Descarga</span>
<a href=#descarga class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Para ello tenemos que descargarnos el ensamblador (disponible en la sección <a href=#herramientas>Herramientas</a>). Al descomprimir el archivo, obtenemos una carpeta <code>ENS2001-Windows</code> como la siguiente:</p><p><a class=lightgallery href=/es/posts/tdl/images/image2.png title="Carpeta de Descarga" data-thumbnail=/es/posts/tdl/images/image2.png data-sub-html="<h2>Carpeta de Descarga</h2>"><img loading=lazy src=/es/posts/tdl/images/image2.png alt="Carpeta de Descarga" height=760 width=845></a></p><p>A excepción del fichero <code>codobj.ens</code>, que es el que vamos a ensamblar, el resto de archivos vienen por defecto. Se incluyen algunos ejemplos y dos ficheros que se recomienda leer: <code>leeme.txt</code> y <code>bugs.txt</code>.</p><h3 class=heading-element id=ensamblador><span>4.3 Ensamblador</span>
<a href=#ensamblador class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>El ensamblador es el ejecutable que viene seleccionado en la captura de arriba (<code>winens</code>).</p><p>Una vez ejecutado, veremos una interfaz como la siguiente:</p><p><a class=lightgallery href=/es/posts/tdl/images/image3.png title=Ensamblador data-thumbnail=/es/posts/tdl/images/image3.png data-sub-html="<h2>Ensamblador</h2>"><img loading=lazy src=/es/posts/tdl/images/image3.png alt=Ensamblador height=416 width=628></a></p><p>Para ver con claridad lo que va haciendo el ensamblador se recomienda abrir las siguientes ventanas:</p><p><a class=lightgallery href=/es/posts/tdl/images/image4.png title=Ventanas data-thumbnail=/es/posts/tdl/images/image4.png data-sub-html="<h2>Ventanas</h2>"><img loading=lazy src=/es/posts/tdl/images/image4.png alt=Ventanas height=138 width=211></a></p><ul><li><p>La <strong>ventana del código fuente</strong> muestra el orden en el que se ejecutan las instrucciones del código objeto. En este caso como aun no se ha cargado ningun archivo, están todas las direcciones en <code>NOP</code>.</p><p><a class=lightgallery href=/es/posts/tdl/images/image5.png title="Código fuente" data-thumbnail=/es/posts/tdl/images/image5.png data-sub-html="<h2>Código fuente</h2>"><img loading=lazy src=/es/posts/tdl/images/image5.png alt="Código fuente" height=291 width=259></a></p></li><li><p>La <strong>ventana de registros</strong> muestra el estado de los registros de la máquina.</p><p><a class=lightgallery href=/es/posts/tdl/images/image6.png title=Registros data-thumbnail=/es/posts/tdl/images/image6.png data-sub-html="<h2>Registros</h2>"><img loading=lazy src=/es/posts/tdl/images/image6.png alt=Registros height=427 width=164></a></p></li><li><p>La <strong>ventana de la pila</strong> muestra el contenido de la pila de datos.</p><p><a class=lightgallery href=/es/posts/tdl/images/image7.png title=Pila data-thumbnail=/es/posts/tdl/images/image7.png data-sub-html="<h2>Pila</h2>"><img loading=lazy src=/es/posts/tdl/images/image7.png alt=Pila height=292 width=154></a></p></li></ul><p>Para cargar el archivo <code>codobj.ens</code> hacemos <code>Archivo > Abrir y Ensamblar</code>. Si todo va bien, nos dirá que ha sido ensamblado correctamente:</p><p><a class=lightgallery href=/es/posts/tdl/images/image8.png title="Ventana de Ensamblado" data-thumbnail=/es/posts/tdl/images/image8.png data-sub-html="<h2>Ventana de Ensamblado</h2>"><img loading=lazy src=/es/posts/tdl/images/image8.png alt="Ventana de Ensamblado" height=416 width=626></a></p><p>Ahora ya estamos listos para ejecutar el ensamblador. Al darle al ▶️ se ejecutará el ensamblador y nos mostrará el resultado. Si nuestro código ejecuta funciones de escritura en consola, esta se abrirá. En nuestro caso hemos ensamblado el fichero <code>expr.txt</code> (disponible en el repositorio de GitHub), y el resultado es el siguiente:</p><p><a class=lightgallery href=/es/posts/tdl/images/image9.png title="Resultado del Ensamblador" data-thumbnail=/es/posts/tdl/images/image9.png data-sub-html="<h2>Resultado del Ensamblador</h2>"><img loading=lazy src=/es/posts/tdl/images/image9.png alt="Resultado del Ensamblador" height=351 width=459></a></p><p>Introducimos un dígito como nos pide y le damos al enter.</p><p><a class=lightgallery href=/es/posts/tdl/images/image10.png title="Resultado del Ensamblador 2" data-thumbnail=/es/posts/tdl/images/image10.png data-sub-html="<h2>Resultado del Ensamblador 2</h2>"><img loading=lazy src=/es/posts/tdl/images/image10.png alt="Resultado del Ensamblador 2" height=351 width=459></a></p><p>Escribimos nuestro nombre:</p><p><a class=lightgallery href=/es/posts/tdl/images/image11.png title="Resultado del Ensamblador 3" data-thumbnail=/es/posts/tdl/images/image11.png data-sub-html="<h2>Resultado del Ensamblador 3</h2>"><img loading=lazy src=/es/posts/tdl/images/image11.png alt="Resultado del Ensamblador 3" height=605 width=737></a></p><p>Y tras esto, el programa finaliza su ejecución correctamente.</p><hr><h2 class=heading-element id=uso><span>5 Uso</span>
<a href=#uso class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>En esta sección se detallan los pasos necesarios para instalar las dependencias, compilar el proyecto y ejecutar cada componente.</p><h3 class=heading-element id=instalación-de-dependencias><span>5.1 Instalación de dependencias</span>
<a href=#instalaci%c3%b3n-de-dependencias class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Para instalar la biblioteca del procesador (<code>ts-lib.jar</code>) en el repositorio local de Maven, ejecuta el siguiente comando:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>mvn</span> <span class=n>install</span><span class=err>:</span><span class=nb>install-file</span> <span class=n>-Dfile</span><span class=p>=</span><span class=s2>&#34;.\lib\ts-lib.jar&#34;</span> <span class=n>-DgroupId</span><span class=p>=</span><span class=n>tslib</span> <span class=n>-DartifactId</span><span class=p>=</span><span class=nb>ts-lib</span> <span class=n>-Dversion</span><span class=p>=</span><span class=s2>&#34;1.0&#34;</span> <span class=n>-Dpackaging</span><span class=p>=</span><span class=n>jar</span></span></span></code></pre></td></tr></table></div></div><p>O si estás en Linux o macOS:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mvn install:install-file -Dfile<span class=o>=</span><span class=s2>&#34;./lib/ts-lib.jar&#34;</span> -DgroupId<span class=o>=</span>tslib -DartifactId<span class=o>=</span>ts-lib -Dversion<span class=o>=</span><span class=s2>&#34;1.0&#34;</span> -Dpackaging<span class=o>=</span>jar</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=compilación-del-procesador><span>5.2 Compilación del procesador</span>
<a href=#compilaci%c3%b3n-del-procesador class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Una vez instalada la librería, genera el ejecutable del procesador con:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>mvn</span> <span class=n>clean</span> <span class=n>package</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=ejecución-del-procesador><span>5.3 Ejecución del procesador</span>
<a href=#ejecuci%c3%b3n-del-procesador class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Después de compilar, puedes ejecutar el procesador con el siguiente comando (sustituyendo la ruta por la del archivo Boreal):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java -jar .<span class=se>\t</span>arget<span class=se>\t</span>dl-1.0-SNAPSHOT-jar-with-dependencies.jar .<span class=se>\r</span>uta<span class=se>\a</span>l<span class=se>\f</span>icheroBoreal.txt</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=ejecución-del-traductor><span>5.4 Ejecución del traductor</span>
<a href=#ejecuci%c3%b3n-del-traductor class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Desde la carpeta <code>gco/</code>, donde se encuentra el ejecutable del traductor, ejecuta:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>.\</span><span class=n>_gco</span> <span class=p>..\</span><span class=n>tdl</span><span class=p>\</span><span class=n>src</span><span class=p>\</span><span class=n>test</span><span class=p>\</span><span class=n>resources</span><span class=p>\</span><span class=n>ficheroboreal</span><span class=p>.</span><span class=n>txt</span></span></span></code></pre></td></tr></table></div></div><p>O si estás en Linux o macOS:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./_gco ../tdl/src/test/resources/ficheroboreal.txt</span></span></code></pre></td></tr></table></div></div><p>Esto generará todos los archivos del procesador, así como el fichero <code>cuartetos.txt</code> (código intermedio) y <code>codobj.ens</code> (código objeto).</p><h3 class=heading-element id=ejecución-del-código-objeto><span>5.5 Ejecución del código objeto</span>
<a href=#ejecuci%c3%b3n-del-c%c3%b3digo-objeto class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>Para ejecutar el archivo <code>.ens</code>, es necesario descargar el ensamblador (disponible en la sección Herramientas), compilarlo y ejecutarlo con el fichero <code>codobj.ens</code> generado.</p><hr><h2 class=heading-element id=herramientas><span>6 Herramientas</span>
<a href=#herramientas class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>Tanto el procesador de lenguajes como los ensambladores simbólicos para ensamblar el código objeto (ENS2001) se encuentran en el siguiente enlace:</p><blockquote><p>👉 <a href=https://dlsiis.fi.upm.es/traductores/Herramientas.html target=_blank rel="external nofollow noopener noreferrer">https://dlsiis.fi.upm.es/traductores/Herramientas.html</a></p></blockquote><p>Podéis encontrar el código fuente de esta implementación en mi repositorio de GitHub:</p><blockquote><p>👉 <a href=https://github.com/azuar4e/TDL target=_blank rel="external nofollow noopener noreferrer">https://github.com/azuar4e/TDL</a></p></blockquote><hr><h2 class=heading-element id=conclusión><span>7 Conclusión</span>
<a href=#conclusi%c3%b3n class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>El proyecto es una gran oportunidad para aprender y profundizar sobre el funcionamiento de un compilador. Aunque este esta basado en un lenguaje y un ensamblador que en el día a día no se utilizan, nos sirve como ejemplo didáctico y sencillo para explicar los conceptos clave.</p><p>Nuevamente el código fuente lo podeís encontrar en mi repositorio de GitHub.</p><p>Have a nice life! 👋</p></div><hr class=awesome-hr><h2 id=see-also>Contenido relacionado</h2><ul><li><a href=/es/posts/sos/ title="Servicio RESTful">Servicio RESTful</a></li></ul><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Actualizado el 2025-06-17 12:30:24">Actualizado el 2025-06-17&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/es/posts/tdl/index.md title="Leer Markdown" class=link-to-markdown>Leer Markdown</a></span><span><a href="https://github.com/azuar4e/azuar4e.github.io/blob/main/content/posts/university/tdl/index.md?plain=1" title="Ver fuente" target=_blank rel="external nofollow noopener noreferrer" class=link-to-source>Ver fuente</a></span><span><a href=https://github.com/azuar4e/azuar4e.github.io/edit/main/content/posts/university/tdl/index.md title="Editar esta página" target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>Editar esta página</a></span><span><a href="https://github.com/azuar4e/azuar4e.github.io/issues/new?title=[BUG]%20Traductor+de+Lenguajes&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cTraductor+de+Lenguajes%7c%0A%7cURL%7chttps://azuar4e.github.io/es/posts/tdl/%7c%0A%7cFilename%7chttps://github.com/azuar4e/azuar4e.github.io/blob/main/content/posts/university/tdl/index.md?plain=1%7c" title="Reportar problema" target=_blank rel="external nofollow noopener noreferrer" class=link-to-report>Reportar problema</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Compartir en X" data-sharer=twitter data-url=https://azuar4e.github.io/es/posts/tdl/ data-title="Traductor De Lenguajes" data-via=azuar4e data-hashtags=Java,Python><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Compartir en Linkedin" data-sharer=linkedin data-url=https://azuar4e.github.io/es/posts/tdl/><i class="fa-brands fa-linkedin fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Compartir en WhatsApp" data-sharer=whatsapp data-url=https://azuar4e.github.io/es/posts/tdl/ data-title="Traductor De Lenguajes" data-web><i class="fa-brands fa-whatsapp fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Compartir en Reddit" data-sharer=reddit data-url=https://azuar4e.github.io/es/posts/tdl/><i class="fa-brands fa-reddit fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/es/tags/java/ class=post-tag title="Etiquetas - Java">Java</a><a href=/es/tags/python/ class=post-tag title="Etiquetas - Python">Python</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Regresar</a></span>&nbsp;|&nbsp;<span><a href=/es/>Inicio</a></span></section></div><div class=post-nav><a href=/es/posts/sos/ class=post-nav-item rel=next title="Servicio RESTful">Servicio RESTful<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label=Contenido><h2 class=toc-title>Contenido&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">Provisto por <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.147.8"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> | Tema - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.3.21-b2e6f70a"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2025</span><span class=author itemprop=copyrightHolder>
<a href=https://www.linkedin.com/in/angel-azuara/ target=_blank rel="external nofollow noopener noreferrer">Angel Azuara Eizaguirre</a></span></div><div class="footer-line statistics order-3"><span class=site-time title='El sitio se está ejecutando ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i><span class="run-times ms-1">El sitio se está ejecutando ...</span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label="Volver arriba"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div></div><a href=https://github.com/azuar4e/azuar4e.github.io title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#8581dd;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>Este sitio web funciona mejor con JavaScript habilitado.</div></noscript></div><link rel=stylesheet href=/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.js?features=Array.prototype.fill%2CArray.prototype.find%2CArray.from%2CIntersectionObserver%2CMath.sign%2CObject.assign%2CPromise%2CObject.entries%2Chtml5shiv%2CObject.values%2Cfetch%2CElement.prototype.after"></script><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/algoliasearch/algoliasearch-lite.umd.min.js defer></script><script src=/lib/lightgallery/lightgallery.min.js defer></script><script src=/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=/lib/lightgallery/plugins/zoom/lg-zoom.min.js defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/lib/pace/pace.min.js async defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"Copiar al portapapeles",maxShownLines:50},comment:{enable:!1},cookieconsent:{content:{dismiss:"De acuerdo",link:"Aprende más",message:"Este sitio web utiliza Cookies para mejorar su experiencia."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},lightgallery:!0,search:{algoliaAppID:"L5YIFQ7E5O",algoliaIndex:"miblog_algolia_es",algoliaSearchKey:"4730818b3e23ce341fdbb2edbce34eda",highlightTag:"em",maxResultLength:10,noResultsFound:"No se encontraron resultados",snippetLength:50,type:"algolia"},siteTime:"2025-06-20T00:00:00+02:00",version:"v0.3.21-b2e6f70a"}</script><script src=/js/theme.min.js defer></script></body></html>